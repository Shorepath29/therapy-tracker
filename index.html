import React, { useState, useMemo } from 'react';
import { Search, Clock, MapPin, Users, AlertCircle, Filter, User } from 'lucide-react';

const TherapistTracker = () => {
  const [searchTerm, setSearchTerm] = useState('');
  const [filterLocation, setFilterLocation] = useState('');
  const [filterClientType, setFilterClientType] = useState('');
  const [filterTimeOfDay, setFilterTimeOfDay] = useState('');

  const therapists = [
    {
      name: "Natalie Dulin",
      availability: "Mornings, Afternoons",
      location: "Virtual",
      clientTypes: ["Individuals"],
      schedule: "Mon: 11am, Tues: 9am, 11am, 2pm, 5pm (biweekly)",
      acceptingNew: true
    },
    {
      name: "Max Chang",
      availability: "Mornings, Lunch Hour, Evenings",
      location: "Virtual, Andersonville, Loop",
      clientTypes: ["Individuals"],
      schedule: "Mon (Andersonville): 1pm, Tuesday (Loop): 11am, 4pm",
      acceptingNew: true
    },
    {
      name: "Priscilla",
      availability: "Afternoons",
      location: "Virtual, Andersonville",
      clientTypes: ["Individuals", "Couples"],
      schedule: "12pm, 2pm, 3pm every other Wednesday (AV or virtual), 2pm Tuesdays (virtual)",
      acceptingNew: true
    },
    {
      name: "Gianna Saviano",
      availability: "Mornings, Afternoons",
      location: "Virtual",
      clientTypes: ["Couples", "Individuals"],
      schedule: "Biweekly 10am Thursdays, Weekly 4pm Wednesdays",
      acceptingNew: true
    },
    {
      name: "Jamelle Apolinar",
      availability: "Afternoons, Weekends",
      location: "Virtual, Andersonville",
      clientTypes: ["Individuals", "Couples"],
      schedule: "Fridays (Virtual): 8am, 10-12pm, 6-8pm; Saturdays (AV): 12pm (virtual only), 1-6pm; Sundays (AV): 10am-3pm, 6pm (virtual only)",
      acceptingNew: true
    },
    {
      name: "Zubia Siddiqui",
      availability: "Lunch Hour, Afternoons",
      location: "Virtual",
      clientTypes: ["Individuals"],
      schedule: "Mondays: 2pm, 3pm (weekly), 7pm (biweekly). Also Tuesdays and Thursdays",
      acceptingNew: true
    },
    {
      name: "Jess Munzer",
      availability: "Late mornings, Lunch Hour",
      location: "Andersonville, Loop, Virtual",
      clientTypes: ["Couples", "Kids/Teens"],
      schedule: "Tues lunch/afternoon (Loop/Virtual), Wed lunch/afternoon/evenings (Virtual), Thu lunch/afternoon/evenings",
      acceptingNew: true
    },
    {
      name: "Maria Fernanda Chumacero",
      availability: "Mornings, Lunch Hour, Afternoons",
      location: "Loop, Virtual",
      clientTypes: ["Individuals", "Kids/Teens"],
      schedule: "Monday (Loop): 12, 1, 4, 5, 7; Tuesday (Loop): 1",
      acceptingNew: true
    },
    {
      name: "Claudia Hindo",
      availability: "Mornings, Lunch hour, Afternoons",
      location: "Loop, Virtual",
      clientTypes: ["Individuals", "Families", "Couples"],
      schedule: "Not taking new clients at the moment",
      acceptingNew: false
    },
    {
      name: "Tricia Dwyer",
      availability: "Afternoons, Evenings",
      location: "Andersonville, Loop",
      clientTypes: ["Couples", "Individuals"],
      schedule: "Open to pretty much anything!",
      acceptingNew: true
    },
    {
      name: "Sowmya",
      availability: "Evenings, Afternoons",
      location: "Loop, Virtual",
      clientTypes: ["Individuals", "Couples"],
      schedule: "Mon: 4pm, 6pm; Tuesday: 10am, 5pm; Fri: noon",
      acceptingNew: true
    },
    {
      name: "Innis Hitt",
      availability: "Mornings, Lunch Hour, Afternoons",
      location: "Andersonville, Loop, Virtual",
      clientTypes: ["Couples", "Individuals"],
      schedule: "Tuesdays (Loop/Virtual): 3, 4, 5, 6, 7; Wednesdays (Virtual): 10-1 and (Loop): 3, 4, 6, 7",
      acceptingNew: true
    },
    {
      name: "Rolando Torres",
      availability: "Mornings, Afternoons",
      location: "Virtual, Andersonville",
      clientTypes: ["Couples", "Individuals"],
      schedule: "Tuesdays: AV 10am, Virtual 3:30pm; Thursdays: Virtual 10am, 1pm, 2pm, 4:30pm",
      acceptingNew: true
    },
    {
      name: "Bria Jennings",
      availability: "Afternoons, Evenings",
      location: "Andersonville, Virtual",
      clientTypes: ["Individuals", "Couples", "Families"],
      schedule: "Sunday (AV, Virtual): 12pm-5pm; Wednesday (AV, Virtual): 4pm-9pm",
      acceptingNew: true
    },
    {
      name: "Austin Ross",
      availability: "Lunch Hour, Mornings",
      location: "Virtual",
      clientTypes: ["Individuals", "Couples"],
      schedule: "Mondays: 8am, 9am, 11am, 12pm, 1pm weekly; 10am bi-weekly",
      acceptingNew: true
    },
    {
      name: "Tulika",
      availability: "Mornings, Lunch Hour, Afternoons",
      location: "Andersonville, Virtual",
      clientTypes: ["Couples", "Individuals"],
      schedule: "Monday (Virtual): 10am-12pm, 1pm-7pm; Tuesday (Virtual): 10am-12pm, 1pm-7pm",
      acceptingNew: true
    },
    {
      name: "Hebe",
      availability: "Mornings, Lunch Hour, Afternoons",
      location: "Andersonville, Loop, Virtual",
      clientTypes: ["Couples", "Individuals"],
      schedule: "Monday AV/Virtual: Morning, Afternoon, Evening; Tuesday AV/Virtual: Lunch Hour, Afternoon, Evening",
      acceptingNew: true
    },
    {
      name: "Kat Tepas",
      availability: "Lunch Hour, Afternoons",
      location: "Virtual",
      clientTypes: ["Couples", "Individuals"],
      schedule: "Open for anything except addiction, active suicidality and high conflict. Lots of openings around lunch",
      acceptingNew: true
    },
    {
      name: "Jamie Suh",
      availability: "Mornings, Lunch Hour, Afternoons",
      location: "Andersonville, Loop, Virtual",
      clientTypes: ["Couples", "Individuals"],
      schedule: "Open Schedule",
      acceptingNew: true
    },
    {
      name: "Alexa Cilia",
      availability: "Mornings, Lunch Hour, Afternoons",
      location: "Andersonville, Loop, Virtual",
      clientTypes: ["Couples", "Individuals", "Families"],
      schedule: "Mondays (virtual): 10, 11, 12, 1, 2, 3; Tuesdays (virtual): 11, 12, 1, 2, 3, 4, 5, 6",
      acceptingNew: true
    },
    {
      name: "Damian J. Flores",
      availability: "Mornings, Lunch Hour, Afternoons",
      location: "Loop, Virtual",
      clientTypes: ["Couples", "Individuals"],
      schedule: "Monday mornings in the Loop: 12:00-2:30pm (In Office); Wednesday: 10:00-8:00pm (virtual)",
      acceptingNew: true
    },
    {
      name: "Jacqueline Lee",
      availability: "Mornings, Lunch Hour, Afternoons",
      location: "Andersonville, Virtual",
      clientTypes: ["Couples", "Kids/Teens"],
      schedule: "Schedule details not provided",
      acceptingNew: true
    }
  ];

  const filteredTherapists = useMemo(() => {
    return therapists.filter(therapist => {
      const matchesSearch = therapist.name.toLowerCase().includes(searchTerm.toLowerCase());
      const matchesLocation = !filterLocation || therapist.location.toLowerCase().includes(filterLocation.toLowerCase());
      const matchesClientType = !filterClientType || therapist.clientTypes.some(type => 
        type.toLowerCase().includes(filterClientType.toLowerCase())
      );
      const matchesTimeOfDay = !filterTimeOfDay || therapist.availability.toLowerCase().includes(filterTimeOfDay.toLowerCase());
      
      return matchesSearch && matchesLocation && matchesClientType && matchesTimeOfDay;
    });
  }, [searchTerm, filterLocation, filterClientType, filterTimeOfDay]);

  const availableCount = filteredTherapists.filter(t => t.acceptingNew).length;
  const totalCount = filteredTherapists.length;

  const getStatusColor = (accepting) => {
    return accepting ? 'bg-green-100 text-green-800 border-green-200' : 'bg-red-100 text-red-800 border-red-200';
  };

  const getLocationIcon = (location) => {
    if (location.includes('Virtual')) return 'üíª';
    if (location.includes('Andersonville')) return 'üè¢';
    if (location.includes('Loop')) return 'üèôÔ∏è';
    return 'üìç';
  };

  return (
    <div className="min-h-screen bg-gray-50 p-6">
      <div className="max-w-7xl mx-auto">
        {/* Header */}
        <div className="mb-8">
          <h1 className="text-3xl font-bold text-gray-900 mb-2">Therapist Availability Tracker</h1>
          <p className="text-gray-600">
            {availableCount} of {totalCount} therapists currently accepting new clients
          </p>
        </div>

        {/* Search and Filters */}
        <div className="bg-white rounded-lg shadow-sm border p-6 mb-6">
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div className="relative">
              <Search className="absolute left-3 top-3 h-4 w-4 text-gray-400" />
              <input
                type="text"
                placeholder="Search therapists..."
                className="pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                value={searchTerm}
                onChange={(e) => setSearchTerm(e.target.value)}
              />
            </div>

            <div className="relative">
              <MapPin className="absolute left-3 top-3 h-4 w-4 text-gray-400" />
              <select
                className="pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                value={filterLocation}
                onChange={(e) => setFilterLocation(e.target.value)}
              >
                <option value="">All Locations</option>
                <option value="Virtual">Virtual</option>
                <option value="Andersonville">Andersonville</option>
                <option value="Loop">Loop</option>
              </select>
            </div>

            <div className="relative">
              <Users className="absolute left-3 top-3 h-4 w-4 text-gray-400" />
              <select
                className="pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                value={filterClientType}
                onChange={(e) => setFilterClientType(e.target.value)}
              >
                <option value="">All Client Types</option>
                <option value="Individuals">Individuals</option>
                <option value="Couples">Couples</option>
                <option value="Families">Families</option>
                <option value="Kids/Teens">Kids/Teens</option>
              </select>
            </div>

            <div className="relative">
              <Clock className="absolute left-3 top-3 h-4 w-4 text-gray-400" />
              <select
                className="pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                value={filterTimeOfDay}
                onChange={(e) => setFilterTimeOfDay(e.target.value)}
              >
                <option value="">All Times</option>
                <option value="Mornings">Mornings</option>
                <option value="Lunch">Lunch Hour</option>
                <option value="Afternoons">Afternoons</option>
                <option value="Evenings">Evenings</option>
                <option value="Weekends">Weekends</option>
              </select>
            </div>
          </div>
        </div>

        {/* Therapist Cards */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {filteredTherapists.map((therapist, index) => (
            <div key={index} className="bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow">
              <div className="p-6">
                {/* Header */}
                <div className="flex items-start justify-between mb-4">
                  <div className="flex items-center">
                    <div className="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                      <User className="h-5 w-5 text-blue-600" />
                    </div>
                    <div>
                      <h3 className="font-semibold text-gray-900">{therapist.name}</h3>
                      <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${getStatusColor(therapist.acceptingNew)}`}>
                        {therapist.acceptingNew ? (
                          <>
                            <div className="w-1.5 h-1.5 bg-green-400 rounded-full mr-1"></div>
                            Available
                          </>
                        ) : (
                          <>
                            <AlertCircle className="w-3 h-3 mr-1" />
                            Not Available
                          </>
                        )}
                      </span>
                    </div>
                  </div>
                </div>

                {/* Availability Times */}
                <div className="mb-3">
                  <div className="flex items-center text-sm text-gray-600 mb-1">
                    <Clock className="h-4 w-4 mr-1" />
                    <span className="font-medium">Available:</span>
                  </div>
                  <p className="text-sm text-gray-800 ml-5">{therapist.availability}</p>
                </div>

                {/* Location */}
                <div className="mb-3">
                  <div className="flex items-center text-sm text-gray-600 mb-1">
                    <MapPin className="h-4 w-4 mr-1" />
                    <span className="font-medium">Location:</span>
                  </div>
                  <p className="text-sm text-gray-800 ml-5">
                    <span className="mr-1">{getLocationIcon(therapist.location)}</span>
                    {therapist.location}
                  </p>
                </div>

                {/* Client Types */}
                <div className="mb-4">
                  <div className="flex items-center text-sm text-gray-600 mb-2">
                    <Users className="h-4 w-4 mr-1" />
                    <span className="font-medium">Specializes in:</span>
                  </div>
                  <div className="flex flex-wrap gap-1 ml-5">
                    {therapist.clientTypes.map((type, idx) => (
                      <span key={idx} className="inline-flex items-center px-2 py-1 rounded-md text-xs bg-blue-50 text-blue-700 border border-blue-200">
                        {type}
                      </span>
                    ))}
                  </div>
                </div>

                {/* Schedule Details */}
                <div className="border-t pt-3">
                  <p className="text-xs font-medium text-gray-600 mb-1">Schedule Details:</p>
                  <p className="text-xs text-gray-700 leading-relaxed">{therapist.schedule}</p>
                </div>
              </div>
            </div>
          ))}
        </div>

        {/* No Results */}
        {filteredTherapists.length === 0 && (
          <div className="text-center py-12">
            <AlertCircle className="h-12 w-12 text-gray-400 mx-auto mb-4" />
            <h3 className="text-lg font-medium text-gray-900 mb-2">No therapists found</h3>
            <p className="text-gray-600">Try adjusting your search criteria</p>
          </div>
        )}

        {/* Footer Stats */}
        <div className="mt-8 bg-white rounded-lg shadow-sm border p-6">
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
            <div>
              <div className="text-2xl font-bold text-green-600">{therapists.filter(t => t.acceptingNew).length}</div>
              <div className="text-sm text-gray-600">Available</div>
            </div>
            <div>
              <div className="text-2xl font-bold text-red-600">{therapists.filter(t => !t.acceptingNew).length}</div>
              <div className="text-sm text-gray-600">Not Available</div>
            </div>
            <div>
              <div className="text-2xl font-bold text-blue-600">{therapists.length}</div>
              <div className="text-sm text-gray-600">Total Therapists</div>
            </div>
            <div>
              <div className="text-2xl font-bold text-purple-600">
                {Math.round((therapists.filter(t => t.acceptingNew).length / therapists.length) * 100)}%
              </div>
              <div className="text-sm text-gray-600">Availability Rate</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default TherapistTracker;
